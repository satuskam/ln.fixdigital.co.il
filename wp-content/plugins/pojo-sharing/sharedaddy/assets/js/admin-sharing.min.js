(function(a){a(document).ready(function(){function f(){a(".preview a.sharing-anchor").unbind("mouseenter mouseenter").hover(function(){if(a(this).data("hasappeared")!==true){var j=a(".sharing-hidden .inner");var i=a(this).parents("li");var k=setTimeout(function(){a(j).css({left:a(i).position().left+"px",top:a(i).position().top+a(i).height()+3+"px"}).slideDown(200,function(){a(i).data("hasappeared",true).data("hasoriginal",true).data("hasitem",false);a(j).mouseleave(p).mouseenter(m);a(i).mouseleave(o).mouseenter(l);a(i).click(n)});var p=function(){a(i).data("hasitem",false);if(a(i).data("hasoriginal")===false){var q=setTimeout(n,800);a(i).data("timer2",q)}};var m=function(){a(i).data("hasitem",true);clearTimeout(a(i).data("timer2"))};var o=function(){a(i).data("hasoriginal",false);if(a(i).data("hasitem")===false){var q=setTimeout(n,800);a(i).data("timer2",q)}};var l=function(){a(i).data("hasoriginal",true);clearTimeout(a(i).data("timer2"))};var n=function(){j.slideUp(200);a(i).unbind("mouseleave",o).unbind("mouseenter",l);a(j).unbind("mouseleave",p).unbind("mouseenter",p);a(i).data("hasappeared",false);a(i).unbind("click",n);return false}},200);a(this).data("timer",k)}},function(){clearTimeout(a(this).data("timer"));a(this).data("timer",false)})}function c(){var i;var j=a("#button_style").val();a("#live-preview ul.preview li").remove();if(a("#save-enabled-shares input[name=visible]").val()!=""||a("#save-enabled-shares input[name=hidden]").val()!=""){a("#live-preview ul.preview").append(a("#live-preview ul.archive .sharing-label").clone())}a("ul.services-enabled li").each(function(){if(a(this).hasClass("service")){var k=a(this).attr("id");a("#live-preview ul.preview").append(a("#live-preview ul.archive li.preview-"+k).clone())}});if(a("#save-enabled-shares input[name=hidden]").val()!=""){a("#live-preview ul.preview").append(a("#live-preview ul.archive .share-more").parent().clone());a(".sharing-hidden ul li").remove();a("ul.services-hidden li").each(function(m,l){if(a(this).hasClass("service")){var k=a(this).attr("id");a(".sharing-hidden .inner ul").append(a("#live-preview ul.archive .preview-"+k).clone())}});f()}a("#live-preview div.sharedaddy").removeClass("sd-social-icon");a("#live-preview li.advanced").removeClass("no-icon");if("icon"==j){a("#live-preview ul.preview div span").html("&nbsp;").parent().addClass("no-text");a("#live-preview div.sharedaddy").addClass("sd-social-icon")}else{if("official"==j){a("#live-preview ul.preview .advanced").each(function(k){if(!a(this).hasClass("preview-press-this")&&!a(this).hasClass("preview-email")&&!a(this).hasClass("preview-print")&&!a(this).hasClass("share-custom")){a(this).find(".option a span").html("").parent().removeClass("sd-button").parent().attr("class","option option-smart-on")}})}else{if("text"==j){a("#live-preview li.advanced").addClass("no-icon")}}}}function g(){var i=this;a(this).parents("li:first").css("backgroundImage",'url("'+sharing_loading_icon+'")');a(this).parents("form").ajaxSubmit(function(j){if(j.indexOf("<!---")>=0){var k=j.substring(0,j.indexOf("<!--->"));var l=j.substring(j.indexOf("<!--->")+6);if(a(i).is(":submit")===true){a(i).parents("li:first").replaceWith(k)}a("#live-preview ul.archive li.preview-"+a(i).parents("form").find("input[name=service]").val()).replaceWith(l)}c();a(i).parents("li:first").removeAttr("style")});if(a(i).is(":submit")===true){return false}return true}function b(i){jQuery("."+i+"-extra-options").css({backgroundColor:"#ffffcc"}).fadeIn()}function e(i){jQuery("."+i+"-extra-options").fadeOut("slow")}function d(){a("#enabled-services h3 img").show();if(a("#enabled-services ul.services-enabled li.service").length>0){a("#drag-instructions").hide()}else{a("#drag-instructions").show()}if(a("#enabled-services li.service").length>0){a("#live-preview .services h2").hide()}else{a("#live-preview .services h2").show()}var j=[],i=[];a("ul.services-enabled li").each(function(){if(a(this).hasClass("service")){j[j.length]=a(this).attr("id");b(a(this).attr("id"))}});a("ul.services-available li").each(function(){if(a(this).hasClass("service")){e(a(this).attr("id"))}});a("ul.services-hidden li").each(function(){if(a(this).hasClass("service")){i[i.length]=a(this).attr("id");b(a(this).attr("id"))}});a("#save-enabled-shares input[name=visible]").val(j.join(","));a("#save-enabled-shares input[name=hidden]").val(i.join(","));c();a("#save-enabled-shares").ajaxSubmit(function(){a("#enabled-services h3 img").hide()})}a("#enabled-services .services ul").sortable({receive:function(i,j){d()},stop:function(){d();a("li.service").enableSelection()},over:function(i,j){a(this).find("ul").addClass("dropping");a("#enabled-services li.end-fix").remove();a("#enabled-services ul").append('<li class="end-fix"></li>')},out:function(i,j){a(this).find("ul").removeClass("dropping");a("#enabled-services li.end-fix").remove();a("#enabled-services ul").append('<li class="end-fix"></li>')},helper:function(i,j){j.find(".advanced-form").hide();return j.clone()},start:function(i,j){a(".advanced-form").hide();a("li.service").disableSelection()},placeholder:"dropzone",opacity:0.8,delay:150,forcePlaceholderSize:true,items:"li",connectWith:"#available-services ul, #enabled-services .services ul",cancel:".advanced-form"});a("#available-services ul").sortable({opacity:0.8,delay:150,cursor:"move",connectWith:"#enabled-services .services ul",placeholder:"dropzone",forcePlaceholderSize:true,start:function(){a(".advanced-form").hide()}});a(".preview-hidden a").click(function(){a(this).parent().find(".preview").toggle();return false});a("#new-service form").ajaxForm({beforeSubmit:function(){a("#new-service-form .error").hide();a("#new-service-form img").show();a("#new-service-form input[type=submit]").prop("disabled",true)},success:function(i){a("#new-service-form img").hide();if(i=="1"){a("#new-service-form .inerror").removeClass("inerror").addClass("error");a("#new-service-form .error").show();a("#new-service-form input[type=submit]").prop("disabled",false)}else{document.location=document.location.href.replace(/&create_new_service=true/i,"")}}});function h(){a("#services-config a.remove").unbind("click").click(function(){var i=a(this).parent().next();a(this).parents("li:first").css("backgroundImage",'url("'+sharing_loading_icon+'")');i.ajaxSubmit(function(j){i.parents("li:first").fadeOut(function(){a(this).remove();c()})});return false})}a("#button_style").change(function(){c();return true}).change();a("input[name=sharing_label]").blur(function(){a("#live-preview h3.sd-title").html(a("<div/>").text(a(this).val()).html())});h();f()})})(jQuery);